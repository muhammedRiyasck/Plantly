<%-include('../layouts/admin/header') %>

  <div class="container-scroller">

    <%-include('../layouts/admin/sidebar') %>

    <div class="container-fluid page-body-wrapper">

        <%-include('../layouts/admin/navbar') %>

      <!-- partial -->

        <div class="main-panel">

          <div class="content-wrapper ">
            <div  id="reloadDiv" class="w-100 container-fluid mb-5  ">
              <table class="table-bordered w-100 mt-4 h-75 table table-active bg-white rounded-2 ">
                

                  <thead style="background-color: rgb(23, 21, 21);border-radius: 10px;" >
                      <tr class="text-center ">
                          <th>No</th>
                          <th>profile</th>
                          <th>Name</th>
                          <th>Email</th>
                          <th>Mobile</th>
                          <th>Status</th>
                          <th>Action</th>
                          
                      </tr>
                  </thead>
                  <tbody style="background-color: rgb(62, 57, 57);color: aliceblue;">
                    
                    

                 <% if (user.length > 0) { %>

                  <%  for(let i =0 ; i < user.length ; i++ ){  %>

                              <tr class="text-center ">
                                  <td><%= i + 1 %></td>
                                  <td>
                                    <img width="80" height="80" src="https://img.icons8.com/office/80/user.png" alt="user"/>                                  </td>
                                  <td><%= user[i].fullName %></td>
                                  <td><%= user[i].email %></td>
                                  <td><%= user[i].mobile %></td>
                                  
                                  <td>

                                    <% if(user[i].is_blocked==false){ %>

                                      <span class="text-success" id="s<%= user[i]._id %>">Active</span>

                                    <% } else{ %>

                                      <span class="text-danger" id="s<%= user[i]._id %>">Blocked</span>

                                    <% } %>

                                  </td>

                                 <td>
                                  <% if(user[i].is_blocked==false){ %>

                                    <button class="btn btn-outline-danger" id="b<%= user[i]._id %>" onclick="userAction('<%= user[i]._id %>')">Block</button>

                                  <% } else { %>

                                    <button class="btn btn-outline-success" id="b<%= user[i]._id %>" onclick="userAction('<%= user[i]._id %>')">Unblock</button>

                                  <% } %>
                                  
                                 </td>
                         
                          
                      </tr>
                      <% } %>
                    
                          <%  } else { %>
                      
                  
                  <tr>
                      <td colspan="7"> Users Not Found</td>
                  </tr>

                  <% } %>

                  

                 
                    
                  </tbody>
              </table><!-- End table -->
            </div>
            
            <%-// include('../layouts/pageNavigation.ejs') %>
           

          </div>

        </div>
    </div>

</div>



<script>

  function userAction(user){

    console.log(user);

   const btn= document.getElementById(`b${user}`)
   const status= document.getElementById(`s${user}`)

   fetch(`/admin/userAction?id=${user}` , {method : 'put'});

   console.log(btn.textContent);
   
   if(btn.textContent=='Block'){


    btn.textContent='Unblock';
    btn.classList.add('btn-outline-success');
    btn.classList.remove('btn-outline-danger')
    status.textContent='Blocked';
    status.classList.add('text-danger')
    status.classList.remove('text-success')
    
}else{

    btn.textContent='Block';
    status.textContent='Active';
    status.classList.remove('text-danger')
    status.classList.add('text-success')
    btn.classList.remove('btn-outline-success');
    btn.classList.add('btn-outline-danger')
    
}


  }


</script>


<%-include('../layouts/admin/footer') %>
